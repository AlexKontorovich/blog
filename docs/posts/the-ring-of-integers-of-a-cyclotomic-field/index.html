<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The ring of integers of a cyclotomic field | Lean community blog</title>
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather&amp;family=Open+Sans&amp;family=Source+Code+Pro:wght@400;600&amp;display=swap" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://leanprover-community.github.io/blog/posts/the-ring-of-integers-of-a-cyclotomic-field/">
<link rel="icon" href="https://leanprover-community.github.io/img/favicon.ico" sizes="48x48">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://leanprover-community.github.io/blog/meta-twitter.png">
<meta name="twitter:title" content="The ring of integers of a cyclotomic field | Lean community blog">
<meta name="author" content="Riccardo Brasca">
<link rel="prev" href="../month-in-mathlib-apr-2022/" title="This month in mathlib (Apr 2022)" type="text/html">
<link rel="next" href="../month-in-mathlib-may-2022/" title="This month in mathlib (May 2022)" type="text/html">
<meta property="og:site_name" content="Lean community blog">
<meta property="og:title" content="The ring of integers of a cyclotomic field">
<meta property="og:url" content="https://leanprover-community.github.io/blog/posts/the-ring-of-integers-of-a-cyclotomic-field/">
<meta property="og:description" content="In PR #13585 we compute the
discriminant of cyclotomic fields. This is an important result, usually treated in a first year
graduate course in number theory. In this post we would like to explain why ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-06-14T10:24:12+02:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
            <header id="header"><h1 id="brand"><a href="../../" title="Lean community blog" rel="home">

        <span id="blog-title">Lean community blog</span>
    </a></h1>

        
            <nav id="menu"><ul>
<li><a href="https://leanprover-community.github.io/">Main site</a></li>
                <li><a href="../../archive.html">Archive</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../about/">About</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>

    
    
    
    </ul></nav></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">The ring of integers of a cyclotomic field</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/riccardo-brasca/">Riccardo Brasca</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2022-06-14T10:24:12+02:00" itemprop="datePublished" title="2022-06-14 10:24">2022-06-14 10:24</time></a>
            </p>
                    <p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>In <a href="https://github.com/leanprover-community/mathlib/pull/13585">PR #13585</a> we compute the
discriminant of cyclotomic fields. This is an important result, usually treated in a first year
graduate course in number theory. In this post we would like to explain why it is an important
result, and briefly explain how we proved it.</p>
<p>Number fields, finite extensions of <code>ℚ</code>, are fundamental objects in modern number theory.
To give a simple application, let us consider the equation <code>x² + 2 = y³</code>, where we are
looking for integers solutions. It's not easy to treat this equation directly in <code>ℤ</code>, since
the left hand side is irreducible. On the other hand, working in <code>ℚ(√-2)</code> (the finite extension
of <code>ℚ</code> obtained adding a root of <code>x² + 2</code>), the equation becomes <code>(x + √-2)(x - (√-2)) = y³</code>.
We have now written a cube as product and we can reason about the prime factors of the left and
of the right hand side. One problem is that <code>ℚ(√-2)</code> is a field, so there is no useful notion of
prime factors. The idea is that the same decomposition holds in <code>ℤ[√-2]</code> (the smallest subring of <code>ℂ</code>
containing <code>√-2</code>).  This is a ring that "looks like <code>ℤ</code>" (to be precise it is a euclidean domain),
and so we can do arithmetic and solve the equation (whose only solution is <code>x = ±5</code> and <code>y = 3</code>).</p>
<p>In the <a href="https://github.com/leanprover-community/flt-regular">flt-regular</a> project we consider the equation
<code>x ^ p + y ^ p = z ^ p</code> over <code>ℤ</code>, where <code>p</code> is a (regular, but this is irrelevant for our discussion)
prime. The natural idea is to consider the field <code>ℚ(ζₚ)</code> and the ring <code>ℤ[ζₚ]</code>, where <code>ζₚ</code> is a primitive
<code>p</code>-th root of unity, to write <code>x ^ p + y ^ p = (x + y)(x + ζₚy)⋯(x + ζₚ ^ (p - 1))</code>. This was indeed the
original ideal to attack Fermat's last theorem, and it can be seen as the birth of algebraic number
theory. Since we want to reason about prime factorization in <code>ℤ[ζₚ]</code>, we need to know that this ring
is well behaved. For example, when it is a UFD, the equation can be completely solved. Unfortunately
this rarely happens, but we can replace unique factorization of elements by unique factorization of
ideals, a property that holds in any Dedekind domain. So we need to know that <code>ℤ[ζₚ]</code> is a Dedekind
domain.</p>
<p>Mathlib already <a href="https://leanprover-community.github.io/blog/posts/dedekind-domains-and-class-number-in-lean/">knows</a>
quite a lot about Dedekind domains. In particular, it knows that the ring of integers of any number
field is such a domain. Given <code>K</code> a number field, its ring of integers <code>𝓞 K</code> is the set of elements
of <code>K</code> that are root of a monic polynomial with integers coefficients. If <code>K = ℚ(α)</code>, with <code>α</code> an
algebraic integer, then <code>ℤ[α] ⊆ 𝓞 K</code>, but in general <code>𝓞 K</code> can be bigger: for example if <code>α = √-3</code>,
then <code>(1 + √-3)/2</code> is a root of <code>x² + x + 1</code> and it lies in <code>𝓞 K</code> but not in <code>ℤ[α]</code>. In general,
<code>𝓞 K</code> is the "correct" ring to work with.</p>
<p>To be able to attack Fermat's Last theorem in the <a href="https://github.com/leanprover-community/flt-regular">flt-regular</a>
project we hence need to explicitly compute <code>𝓞 ℚ(ζₚ)</code>. It turns out that <code>𝓞 ℚ(ζₚ) = ℤ[ζₚ]</code>, as
proved in <a href="https://github.com/leanprover-community/mathlib/pull/13585">PR #13585</a>. This a nontrivial
result, and it is a good demonstration that we can do serious algebraic number theory in mathlib.</p>
<p>We didn't want to prove the result in the fastest way, but we prefer to develop the theory organically,
to pave the way for similar theorem. Here is a short account of what we did. The math proof we decided to
follow is the following.
* First of all we computed the discriminant of <code>ℚ(ζₚ)</code>, that is <code>±p ^ n</code> for some <code>n</code> (both the sign and <code>n</code>
  are actually computed, but they don't matter here).
* Given an algebraic integer <code>α</code>, the discriminant of <code>K = ℚ(α)</code> kills the quotient <code>𝓞 K / ℤ[α]</code>.
* If moreover the minimal polynomial of <code>α</code> is Eiseinstein at a prime <code>p</code>, then for any <code>x ∈ 𝓞 K</code>
  such that <code>p ^ k x ∈ ℤ[α]</code> for some <code>k</code> lies in <code>ℤ[α]</code>.
Since <code>ℚ(ζₚ) = ℚ(εₚ)</code> and <code>ℤ[ζₚ] = ℤ[εₚ]</code>, where <code>εₚ = ζₚ - 1</code> and the minimal polynomial of <code>εₚ</code> is
Eiseinstein at <code>p</code>, the result immediately follows. We actually proved this for the <code>p ^ n</code>-cyclotomic
field, but the strategy is essentially the same.</p>
<p>Beside results specific to cyclotomic fields, the most important part of this work is by far the
introduction of the discriminant in mathlib. The computation of the discriminant of cyclotomic fields
shows that we have enough API to treat, say, the case of quadratic extensions of <code>ℚ</code>. Also, connecting
it with ramification should now be doable.</p>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../month-in-mathlib-apr-2022/" rel="prev" title="This month in mathlib (Apr 2022)">Previous post</a>
            </li>
            <li class="next">
                <a href="../month-in-mathlib-may-2022/" rel="next" title="This month in mathlib (May 2022)">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article></main><footer id="footer"><p>Contents © 2022         The Lean prover community - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
        

    
    
</body>
</html>
